"use strict";(self["webpackChunkvideogatewayweb"]=self["webpackChunkvideogatewayweb"]||[]).push([[171],{9171:function(t,a,e){e.r(a),e.d(a,{default:function(){return r}});var s=function(){var t=this,a=t._self._c;return a("div",[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:t.addRules}},[t._v("新增算法")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"ai_code",label:"报警编号",align:"center"}}),a("el-table-column",{attrs:{prop:"ai_name",label:"算法名称",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.chooseType(e.row,1)}}},[a("i",{staticClass:"icon iconf-model fs-14",attrs:{title:"选择模型分类"}})]),a("el-button",{staticClass:"el-icon-edit",attrs:{type:"text"},on:{click:function(a){return t.editData(e.row)}}}),a("el-button",{staticClass:"el-icon-delete",staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(a){return t.delData(e.row)}}})]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],staticClass:"float-right mt-10",attrs:{total:t.total,page:t.params.page,limit:t.params.size,layout:"total, prev, pager, next",small:""},on:{"update:page":function(a){return t.$set(t.params,"page",a)},"update:limit":function(a){return t.$set(t.params,"size",a)},pagination:t.getDataList}}),a("el-dialog",{attrs:{title:t.title,visible:t.rulesVisible,width:"35%","append-to-body":""},on:{"update:visible":function(a){t.rulesVisible=a}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"报警编号",prop:"ai_code"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:t.form.ai_code,callback:function(a){t.$set(t.form,"ai_code",a)},expression:"form.ai_code"}})],1),a("el-form-item",{attrs:{label:"算法名称",prop:"ai_name"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:t.form.ai_name,callback:function(a){t.$set(t.form,"ai_name",a)},expression:"form.ai_name"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.submitForm("form")}}},[t._v("确认")]),a("el-button",{on:{click:function(a){t.rulesVisible=!1}}},[t._v("取消")])],1)],1),a("el-dialog",{attrs:{title:"模型类型列表",visible:t.modelVisible,width:"65%","append-to-body":"",top:"10px"},on:{"update:visible":function(a){t.modelVisible=a}}},[a("div",{staticClass:"d-flex"},[a("el-tabs",{attrs:{"tab-position":"left"},on:{"tab-click":t.chooseModel},model:{value:t.modelName,callback:function(a){t.modelName=a},expression:"modelName"}},t._l(t.modelList,function(e,s){return a("el-tab-pane",{key:e.model_id,attrs:{label:e.model_name,name:s.toString()}},[a("el-checkbox-group",{attrs:{size:"small"},model:{value:t.checkedTabs,callback:function(a){t.checkedTabs=a},expression:"checkedTabs"}},t._l(t.modelClassList,function(e){return a("el-checkbox",{key:e.class_id,attrs:{label:e.class_id,border:"",disabled:e.checked},on:{change:t.handleCheckedTabs}},[t._v(t._s(e.class_name))])}),1)],1)}),1)],1)])],1)},i=[],l=(e(3239),e(2401),e(3325),e(8530),e(12),e(5077),e(860),e(2419),e(7464),e(2410),{data(){return{tableData:[],title:"新增算法",rulesVisible:!1,form:{},analyseList:[{name:"车辆类型识别",type:1},{name:"车牌识别",type:2},{name:"火焰烟雾识别",type:3}],params:{page:1,size:10},total:0,classList:[],loading:!1,modelVisible:!1,modelClassList:[],modelList:[],modelForm:{},modelName:"0",AiModelClassList:[],modelObj:{},checkedTabs:[]}},created(){this.getDataList(),this.getmodalList(),this.getDataAiModelClassList()},methods:{handleCheckedTabs(t,a){let e=Number(a.target.value);const s=t?"/ai/addDataAiModelClass":"/ai/delDataAiModelClass";this.$api.post(s,{ai_id:this.modelForm.ai_id,class_id:e}).then(()=>{this.$message.success("操作成功")}).catch(()=>{this.checkedTabs=this.checkedTabs.filter(t=>t!==e)})},getDataAiModelClassList(){this.checkedTabs=[],this.$api.get("/ai/getDataAiModelClassList",{params:{ai_id:this.modelForm.ai_id}}).then(t=>{t.data.data&&(this.modelForm.ai_id?(this.checkedTabs=t.data.data.map(t=>t.class_id),this.getDataModelClassList()):this.AiModelClassList=t.data.data)})},chooseModel(t){this.modelObj=this.modelList[t.index],this.getDataModelClassList()},getmodalList(){this.$api.get("/ai/getDataModelList",{params:{model_status:1}}).then(t=>{this.modelList=t.data.data,this.modelObj=this.modelList[0],this.getDataModelClassList()})},chooseClass(t,a){const e=t.indexOf(a)>-1?"/ai/addDataAiModelClass":"/ai/delDataAiModelClass";this.$api.post(e,{ai_id:this.modelForm.ai_id,class_id:a.class_id}).then(()=>{this.$message.success("操作成功")})},getDataModelClassList(){this.$api.get("/ai/getDataModelClassList",{params:{model_id:this.modelObj.model_id}}).then(t=>{this.modelClassList=this.processData(this.AiModelClassList,t.data.data,this.modelForm.ai_id)})},processData(t,a,e){const s=new Set(t.map(t=>t.class_id)),i=new Set(t.filter(t=>t.ai_id===e).map(t=>t.class_id));return a.map(t=>({...t,checked:s.has(t.class_id)&&!i.has(t.class_id)}))},chooseType(t){this.modelForm=t,this.modelVisible=!0,this.getDataAiModelClassList()},delClassItem(t){this.classList.splice(t,1)},delData(t){this.$confirm("是否删除该数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$api.post("/ai/delDataAi",{ai_id:t.ai_id}).then(()=>{this.$message.success("操作成功"),this.getDataList()})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},editData(t){this.title="编辑算法",this.rulesVisible=!0,this.form={...t},this.classList=this.form.class_name?JSON.parse(this.form.class_name).map(t=>({text:t})):[]},addRules(){this.form={},this.classList=[],this.rulesVisible=!0},changeAIType(t){this.form.ai_type_alias=t.name,this.form.ai_type=t.type},submitForm(t){this.form.ai_code=Number(this.form.ai_code),this.$refs[t].validate(t=>{if(!t)return!1;this.form.ai_id?this.$api.post("/ai/updateDataAi",this.form).then(()=>{this.rulesVisible=!1,this.$message.success("操作成功"),this.getDataList()}):this.$api.post("/ai/addDataAi",this.form).then(()=>{this.rulesVisible=!1,this.$message.success("操作成功"),this.getDataList()})})},getDataList(){this.loading=!0,this.$api.get("/ai/getDataAiList",{params:this.params}).then(t=>{t.data.data&&(this.tableData=t.data.data),this.total=t.data.total}).finally(()=>{this.loading=!1})}}}),o=l,d=e(6790),n=(0,d.A)(o,s,i,!1,null,"b888914a",null),r=n.exports}}]);
//# sourceMappingURL=171.1dea0151.js.map